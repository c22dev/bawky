//
//  ezkfd.swift
//  PurityKFD
//
//  Created by Lrdsnow on 8/21/23.
//

import Foundation

func exploit(puaf_pages: UInt64, puaf_method: UInt64, kread_method: UInt64, kwrite_method: UInt64) {
    do_kopen(puaf_pages, puaf_method, kread_method, kwrite_method)
}

func close_exploit() {
    do_kclose()
}

func ez_overwriteFile(from: String, to: String) {
    if to.hasPrefix("/var") || to.hasPrefix("/private/var") {
        funVnodeOverwriteFileUnlimitSize(strdup(to)!, strdup(from)!)
    } else {
        funVnodeOverwrite2(strdup(to)!, strdup(from)!)
    }
}
